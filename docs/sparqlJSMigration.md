# Migration Guide: SparqlJS to Traqula

In this guide we explain how one can migrate from [sparqljs](https://github.com/RubenVerborgh/SPARQL.js) to [Traqula](../).
It is important to note that Traqula has multiple parser and generator builds.
Traqula has builds to [parse](../engines/parser-sparql-1-1) and [generate](../engines/generator-sparql-1-1) SPARQL 1.1,
and also build to [parse](../engines/parser-sparql-1-2) and [generate](../engines/generator-sparql-1-2) SPARQL 1.2.

Since the AST generated by our parser has a different format than sparqlJS, Traqula does not form a drop in replacement on AST level.
However,
Traqula is 6 times faster than sparqlJS,
it allows you to create and patch parsers programmatically,
and it supports round tripping generation, so upgrading might be worthwhile.
(Also note that SparqlJS is planned to be deprecated)

In case you do not care about the AST generated, like when you use SparqlJS for query validation, Traqula can be a drop in replacement.

Using SparqlJS you would parse using:
```typescript
const SparqlParser = require('sparqljs').Parser;
const parser = new SparqlParser();
const parsedQuery = parser.parse(
  'PREFIX foaf: <http://xmlns.com/foaf/0.1/> ' +
  'SELECT * { ?mickey foaf:name "Mickey Mouse"@en; foaf:knows ?other. }');
```

Using Traqula you would write:
```typescript
const SparqlParser = require('@traqula/parser-sparql-1-1').Parser;
const parser = new SparqlParser();
const parsedQuery = parser.parse(
  'PREFIX foaf: <http://xmlns.com/foaf/0.1/> ' +
  'SELECT * { ?mickey foaf:name "Mickey Mouse"@en; foaf:knows ?other. }');
```

For query generation, Traqula support round tripping.
This means that when a query parsed to an AST, that AST will contain the information needed to recreate the exact same query string.
This allows you to perform stable manipulations on your query.
For example, you could rename your variables and regenerate the query, and it would still look similar to the original query.

Using SparqlJS generation is performed like:
```typescript
const SparqlGenerator = require('sparqljs').Generator;
const generator = new SparqlGenerator({ /* prefixes, baseIRI, factory */ });
const generatedQuery = generator.stringify(parsedQuery);
```

Using Traqula:
```typescript
const SparqlGenerator = require('@traqula/generator-sparql-1-1').Generator;
const generator = new SparqlGenerator();
const generatedQuery = generator.generate(parsedQuery, { /* prefixes, baseIri, factory, origSource */ });
```
