# Migration Guide: SparqlAlgebra to Traqula

In this guide we explain how one can migrate from [SPARQLAlgebra.js](https://github.com/joachimvh/SPARQLAlgebra.js) to [Traqula](../).
Migrating from SPARQLAlgebra.js to Traqula is a breeze.
Since Traqula has many parser and generator builds, the algebra transformation is performed ontop of a chosen parser and generator.
As such, the parse step might become a little more explicit in your codebase.
Making this step more explicit can create a performance benefit since your CPU likes to reuse the parser.

The algebra object generated by SPARQLAlgebra.js and Traqula **differ** only in one component: **VALUES**.
Withing SPARQLAlgebra.js the keys of a VALUES object are prefixed with a `?` (likely because this was also the case for [sparqljs](https://github.com/RubenVerborgh/SPARQL.js)), in Traqula the key just the value/ name of the variable.
Concretely, in SPARQLAlgebra.js you have `{ type: "values", variables: [ ... ], bindings: { ?somevar: { ... } } }`
while in Traqula that is simplified to `{ type: "values", variables: [ ... ], bindings: { somevar: { ... } } }`.

Now, to migrate, in SPARQLAlgebra.js you would write:
```typescript
const { translate } = require('sparqlalgebrajs');
const algebra = translate('SELECT * WHERE { ?x ?y ?z }');
```

In Traqula, you would first choose a parser and transform the AST afterward:
```typescript
const { Parser } = require('@traqula/parser-sparql-1-1');
const { toAlgebra } = require('@traqula/algebra-sparql-1-1');

const parser = new Parser();
const ast = parser.parse('SELECT * WHERE { ?x ?y ?z }');
const algebra = toAlgebra(ast);
```

To go from algebra to a SPARQL query string, you would write the following in SPARQLAlgebra.js:
```typescript
const { toSparql } = require('sparqlalgebrajs');
const sparqlQuery = toSparql(algebra)
```

in traqula, you would first need to choose a sparql generator and then:
```typescript
const { Generator } = require('@traqula/generator-sparql-1-1');
const { toAST } = require('@traqula/algebra-sparql-1-1');

const genAst = toAST(algebra);
const generator = new Generator();
const sparqlQuery = generator.generate(genAst);
```
