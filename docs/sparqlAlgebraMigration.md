# Migration Guide: SparqlAlgebra to Traqula

In this guide we explain how one can migrate from [SPARQLAlgebra.js](https://github.com/joachimvh/SPARQLAlgebra.js) to [Traqula](../).
Migrating from SPARQLAlgebra.js to Traqula is a breeze.

The algebra object generated by SPARQLAlgebra.js and Traqula **differ** only in one component: **VALUES**.
Within SPARQLAlgebra.js the keys of a VALUES object are prefixed with a `?` (because this was also the case for [sparqljs](https://github.com/RubenVerborgh/SPARQL.js)), in Traqula the key is just the value/ name of the variable.
Concretely, in SPARQLAlgebra.js you have `{ type: "values", variables: [ ... ], bindings: { ?somevar: { ... } } }`
while in Traqula that is simplified to `{ type: "values", variables: [ ... ], bindings: { somevar: { ... } } }`.

## Migration

SPARQLAlgebra.js allowed you to provide a query string to `toAlgebra`, Traqula does not allow this.
The reason is that Traqula tries to force you to **reuse your parser** since creating one is quite resource intensive.

In SPARQLAlgebra.js you would write:
```typescript
import { translate } from 'sparqlalgebrajs';
const algebra = translate('SELECT * WHERE { ?x ?y ?z }');
```

In Traqula, you would first choose a parser and transform the AST afterward:
```typescript
import { Parser } from '@traqula/parser-sparql-1-1';
import { toAlgebra } from '@traqula/algebra-sparql-1-1';
const parser = new Parser();
const ast = parser.parse('SELECT * WHERE { ?x ?y ?z }');
const algebra = toAlgebra(ast);
```

To go from algebra to a SPARQL query string, you would write the following in SPARQLAlgebra.js:
```typescript
const { toSparql } = require('sparqlalgebrajs');
const sparqlQuery = toSparql(algebra)
```

In Traqula, you would first need to choose a sparql generator and then:
```typescript
import { Generator } from '@traqula/generator-sparql-1-1';
import { toAST } from '@traqula/algebra-sparql-1-1';
const generator = new Generator();
const genAst = toAST(algebra);
const sparqlQuery = generator.generate(genAst);
```
