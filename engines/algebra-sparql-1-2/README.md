<p align="center">
    <img alt="Traqula logo" width="70%" style="border-radius: 20px" src="/assets/white-on-red/logo-white-on-red-lettered-social.png">
</p>

<p align="center">
  <strong>A query language transpiler framework for JavaScript</strong>
</p>

# SPARQL 1.2 AST, SPARQL 1.2 Algebra transformer

[![npm version](https://badge.fury.io/js/@traqula%2Falgebra-sparql-1-2.svg)](https://www.npmjs.com/package/@traqula/algebra-sparql-1-2)

Modular transformer to transform a SPARQL 1.1 AST generated by Traqula to SPARQL 1.1 algebra.
There is also support for 'non-algebra' entities such as ASK, FROM, etc.
to make sure the output contains all relevant information from the query.

## Installation

```bash
npm install @traqula/algebra-sparql-1-2
```

or

```bash
yarn add @traqula/algebra-sparql-1-2
```

## Import

Either through ESM import:

```javascript
import { toAst, toAlgebra } from '@traqula/algebra-sparql-1-2';
```

_or_ CJS require:

```javascript
const { toAst, toAlgebra } = require('@traqula/algebra-sparql-1-2');
```

## Usage

Input for the translation function should be a Traqula AST, by calling [Traqula parser](../parser-sparql-1-1).
Algebra operations are modeled as objects of the structure `{ name: string; input: Operation[] }`.
The transformation is detailed by [section 18.3 of the SPARQL 1.2 specification](https://www.w3.org/TR/sparql12-query/#translation).

The example bellow demonstrates this package usage where we parse a query string and transform it to algebra, from the algebra we will go back to a query string.
Note that unlike the AST level, we do not provide [round tripping](../generator-sparql-1-1/README.md#round-tripping-generation) on algebra level.

```typescript
import { Parser } from '@traqula/parser-sparql-1-2';
import { Generator } from '@traqula/generator-sparql-1-2';
import { toAlgebra, fromAlgebra } from '@traqula/algebra-sparql-1-2';
// Initialize required variables.
const parser = new Parser();
const generator = new Generator();
const query = `SELECT * { ?s ?p ?o }`;

const ast = parser.parse(query);
const algebra = toAlgebra(ast);

const generatedAst = toAst(algebra);
const generatedQuery = generator.generate(generatedAst);
```

The algebra transformer for SPARQL 1.2 is a modification of [the SPARQL 1.1 algebra transformer](../algebra-sparql-1-1); therefore, much of the documentation of that transformer holds here too.
